
<input type="text" name="attr_debug" style="display: none;" value=" "/>
<div class="top">
  <div class="topStats" style="margin-bottom: 1em;">
    <div>
      <div class="inlineBlock graphicalField" style="position: relative;"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/perkLevel.png"/>
        <input type="number" name="attr_perk_level" style="left: 19px; top: 43px; font-size: 2em; font-family: sans-serif; width: 32px; text-align: center;"/>
        <input type="text" name="attr_character_name" style="left: 80px; top: 47px; font-size: 1.5em; font-family: sans-serif; width: 240px;"/>
      </div>
      <div class="inlineBlock" style="position: relative; vertical-align: top; width: 4in;">
        <div class="labelledUnderlined" style="width: 1.5in; position: absolute; top: 45px;">
          <label>Race</label>
          <div class="inner">
            <input type="text" name="attr_race"/>
          </div>
        </div>
        <div class="labelledUnderlined" style="width: 2in; position: absolute; top: 45px; left: 1.6in;">
          <label>Job</label>
          <div class="inner">
            <input type="text" name="attr_classes"/>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="tabsContainer">
  <div class="tab">
    <input type="radio" id="tab_1" name="mainTabs" checked="checked"/>
    <label for="tab_1">Core</label>
    <div class="tabPanel">
      <div class="corePanel">
        <div style="margin-left: 64px;">
          <div class="labelledUnderlined" style="width: 2in;">
            <label>Virtue</label>
            <div class="inner">
              <input type="text" name="attr_virtue"/>
            </div>
          </div>
          <div class="labelledUnderlined" style="width: 2in;">
            <label>Flaw</label>
            <div class="inner">
              <input type="text" name="attr_flaw"/>
            </div>
          </div>
          <div class="labelledUnderlined" style="width: 2in;">
            <label>Quirks</label>
            <div class="inner">
              <input type="text" name="attr_quirks"/>
            </div>
          </div>
          <div class="labelledUnderlined" style="width: 3in;">
            <label>Langaugaes</label>
            <div class="inner">
              <input type="text" name="attr_languages"/>
            </div>
          </div>
          <div class="labelledUnderlined" style="width: 3in;">
            <label>Active Status Conditions</label>
            <div class="inner">
              <input type="text" name="attr_activeConditions"/>
            </div>
          </div>
        </div>
        <div class="inlineBlock" style="width: 50%;">
          <div class="primaryAttribute">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/mind.png"/>
              <div class="readOnlyBox"><span name="attr_mindTotal"></span></div>
              <input type="hidden" name="attr_mindTotal" value="1"/>
              <button type="roll" value="&amp;{template:mlprim5} {{charName=@{character_name}}} {{attr=Mind}} {{result=[[2d6 + @{mindTotal}]]}}"></button>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Base</label>
                <div class="inner">
                  <input type="number" name="attr_mindBase" value="1"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Perks</label>
                <div class="inner">
                  <input type="number" name="attr_mindPerks" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_mindOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_mindTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
          <div class="primaryAttribute">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/body.png"/>
              <div class="readOnlyBox"><span name="attr_bodyTotal"></span></div>
              <input type="hidden" name="attr_bodyTotal" value="1"/>
              <button type="roll" value="&amp;{template:mlprim5} {{charName=@{character_name}}} {{attr=Body}} {{result=[[2d6 + @{mindTotal}]]}}"></button>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Base</label>
                <div class="inner">
                  <input type="number" name="attr_bodyBase" value="1"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Perks</label>
                <div class="inner">
                  <input type="number" name="attr_bodyPerks" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_bodyOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_bodyTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
          <div class="primaryAttribute">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/heart.png"/>
              <div class="readOnlyBox"><span name="attr_heartTotal"></span></div>
              <input type="hidden" name="attr_heartTotal" value="1"/>
              <button type="roll" value="&amp;{template:mlprim5} {{charName=@{character_name}}} {{attr=Heart}} {{result=[[2d6 + @{mindTotal}]]}}"></button>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Base</label>
                <div class="inner">
                  <input type="number" name="attr_heartBase" value="1"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Perks</label>
                <div class="inner">
                  <input type="number" name="attr_heartPerks" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_heartOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_heartTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="inlineBlock" style="width: 48%;">
          <div class="secondaryAttribute" style="margin-bottom: 15px;">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/armor.png"/>
              <input type="number" name="attr_armor" style="left: 22px; top: 28px;" value="0"/>
              <input type="number" name="attr_armor_max" style="left: 54px; top: 28px;" value="@{armorGear} + @{armorOther} + @{armorTemp}" disabled="true"/>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Gear</label>
                <div class="inner">
                  <input type="number" name="attr_armorGear" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_armorOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_armorTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
          <div class="secondaryAttribute" style="margin-bottom: 16px;">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/fortitude.png"/>
              <input type="number" name="attr_fortitude" style="left: 22px; top: 26px;" value="0"/>
              <input type="number" name="attr_fortitude_max" style="left: 54px; top: 26px;" value="@{fortitudeCalc} + @{fortitudeOther} + @{fortitudeTemp}" disabled="true"/>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>2 x Body + Heart</label>
                <div class="inner">
                  <input type="number" name="attr_fortitudeCalc" value="@{bodyTotal}*2 + @{heartTotal}" disabled="true"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_fortitudeOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_fortitudeTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
          <div class="secondaryAttribute">
            <div class="total graphicalField"><img src="https://raw.githubusercontent.com/Cazra/MLPRIM5Roll20CharSheet_DashGalaxy/master/img/willpower.png"/>
              <input type="number" name="attr_willpower" style="left: 22px; top: 26px;" value="0"/>
              <input type="number" name="attr_willpower_max" style="left: 54px; top: 26px;" value="@{willpowerCalc} + @{willpowerOther} + @{willpowerTemp}" disabled="true"/>
            </div>
            <div class="equation">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>2 x Mind + Heart</label>
                <div class="inner">
                  <input type="number" name="attr_willpowerCalc" value="@{mindTotal}*2 + @{heartTotal}" disabled="true"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.5in;">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_willpowerOther" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined" style="width:0.6in;">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_willpowerTemp" value="0"/>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="tab">
    <input type="radio" id="tab_2" name="mainTabs"/>
    <label for="tab_2">Skills</label>
    <div class="tabPanel">
      <div class="skillsPanel">
        <fieldset class="repeating_skills">
          <div style="margin-bottom: 1em;">
            <div class="labelledUnderlined" style="width: 1.25in;">
              <label>Name</label>
              <div class="inner">
                <input type="text" name="attr_name"/>
              </div>
            </div>
            <div class="labelledUnderlined" style="width: 0.4in;">
              <label>Total</label>
              <div class="inner">
                <div class="readOnlyBox"><span name="attr_total"></span></div>
                <input type="hidden" name="attr_total" value="0"/>
              </div>
            </div>
            <div class="equation inlineBlock">
              <div class="mathOperator">=</div>
              <div class="labelledUnderlined">
                <label>Attribute</label>
                <div class="inner">
                  <select name="attr_attr">
                    <option value="derp" selected="selected">Pick One</option>
                    <option value="mind">Mind</option>
                    <option value="body">Body</option>
                    <option value="heart">Heart</option>
                  </select>
                </div>
              </div>
              <input type="hidden" name="attr_attrValue" value="1"/>
              <div class="mathOperator">+</div>
              <div class="checkbox">
                <input type="checkbox" name="attr_trained" title="Trained?: Roll 3d6 instead of 2d6"/><span>T</span>
              </div>
              <div class="checkbox">
                <input type="checkbox" name="attr_improved" title="Improved?: +2 bonus"/><span>I</span>
              </div>
              <div class="checkbox">
                <input type="checkbox" name="attr_greater" title=""/><span>G</span>
              </div>
              <div class="mathOperator">-</div>
              <div class="labelledUnderlined">
                <label>Armor Pen.?</label>
                <div class="inner">
                  <select name="attr_hasArmorPenalty">
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                  </select>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined">
                <label>Other</label>
                <div class="inner">
                  <input type="number" name="attr_other" style="width: 0.4in;" value="0"/>
                </div>
              </div>
              <div class="mathOperator">+</div>
              <div class="labelledUnderlined">
                <label>Temporary</label>
                <div class="inner">
                  <input type="number" name="attr_temp" style="width: 0.6in;" value="0"/>
                </div>
              </div>
            </div>
            <div class="labelledUnderlined">
              <label>Notes</label>
              <div class="inner">
                <input type="text" name="attr_notes" style="font-size: 0.7em;"/>
              </div>
            </div>
            <div class="labelledUnderlined">
              <label>Roll Type</label>
              <div class="inner">
                <select name="attr_rolltype" style="font-size: 0.7em;">
                  <option value="normal" selected="selected">Normal</option>
                  <option value="adv">Advantage</option>
                  <option value="dis">Disadvantage</option>
                </select>
              </div>
            </div>
            <button type="roll" value="&amp;{template:mlprim5} {{charName=@{character_name}}} {{attr=@{name}}} {{result=[[@{equation}]]}} {{notes=@{notes}}}"></button>
            <input type="hidden" name="attr_equation" value="2d6"/>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
  <div class="tab">
    <input type="radio" id="tab_3" name="mainTabs"/>
    <label for="tab_3">Perks</label>
    <div class="tabPanel">
      <div class="perksPanel">
        <fieldset class="repeating_perks">
          <div class="checkbox">
            <input type="checkbox" name="attr_isBonusPerk" title="Bonus Perk?: Check this if this is a bonus perk."/><span>B</span>
          </div>
          <div class="labelledUnderlined" style="width: 1.5in;">
            <label>Name</label>
            <div class="inner">
              <input type="text" name="attr_name"/>
            </div>
          </div>
          <div class="labelledUnderlined">
            <label>Description</label>
            <div class="inner">
              <input type="text" name="attr_desc" style="width: 6in;"/>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </div>
  <div class="tab">
    <input type="radio" id="tab_4" name="mainTabs"/>
    <label for="tab_4">Powers/Abilities</label>
    <div class="tabPanel">
      <div class="powersPanel">
        <fieldset class="repeating_powers">
          <div class="labelledUnderlined">
            <label>Name</label>
            <div class="inner">
              <input type="text" name="attr_name"/>
            </div>
          </div>
          <div class="labelledUnderlined">
            <label>Type</label>
            <div class="inner">
              <select name="attr_type">
                <option value="points">Normal</option>
                <option value="limited">Limited</option>
                <option value="passive">Passive</option>
              </select>
            </div>
          </div>
          <input type="number" name="attr_hidePowerPoints" style="display: none;" value="0" min="1"/>
          <div class="powerPoints inlineBlock">
            <label class="inlineLabel">Power Points:</label>
            <div class="labelledUnderlined">
              <label>Current</label>
              <div class="inner">
                <input type="number" name="attr_powerpoints" style="width: 0.6in;"/>
              </div>
            </div>
            <div class="mathOperator">/</div>
            <div class="labelledUnderlined">
              <label>Max</label>
              <div class="inner">
                <input type="number" name="attr_powerpoints_max" style="width: 0.6in;"/>
              </div>
            </div>
          </div>
          <textarea name="attr_desc" style="height: 4em;" placeholder="description/effects"></textarea>
        </fieldset>
      </div>
    </div>
  </div>
  <div class="tab">
    <input type="radio" id="tab_5" name="mainTabs"/>
    <label for="tab_5">Gear/Equipment</label>
    <div class="tabPanel">
      <div class="gearPanel">
        <div class="inlineBlock" style="width: 50%; vertical-align: top;">
          <h2>Special Equipment</h2>
          <fieldset class="repeating_specialItems">
            <div class="itemCard">
              <div class="header">
                <div class="checkbox">
                  <input type="checkbox" name="attr_equipped" title="Equipped?: Check this if the item is currently equipped."/><span>E</span>
                </div>
                <div class="checkbox" style="width: 32px;">
                  <input type="checkbox" name="attr_isBig" title="Big?: Check this if this is a Big item."/><span>BIG</span>
                </div>
                <input type="text" name="attr_name" placeholder="Item name" style="width: 2in; background: transparent;"/>
                <select name="attr_type" style="width: 1.5in; background: transparent; border: none;">
                  <option value="default" selected="selected">Pick One</option>
                  <option value="Weapon - Melee">Weapon - Melee</option>
                  <option value="Weapon - Polearm">Weapon - Polearm</option>
                  <option value="Weapon - Lash">Weapon - Lash</option>
                  <option value="Weapon - Throwing">Weapon - Throwing</option>
                  <option value="Weapon - Ranged">Weapon - Ranged</option>
                  <option value="Gadget">Gadget</option>
                  <option value="Armor">Armor</option>
                  <option value="Clothes">Clothes</option>
                  <option value="Shield">Shield</option>
                  <option value="Head">Head</option>
                  <option value="Neck">Neck</option>
                  <option value="Back">Back</option>
                  <option value="Waist">Waist</option>
                  <option value="Legs">Legs</option>
                  <option value="Feet">Feet</option>
                  <option value="Accessory">Accessory</option>
                  <option value="Cybernetic">Cybernetic</option>
                  <option value="Other">Other</option>
                  <option value="Consumable">Consumable</option>
                </select>
              </div>
              <div class="body">
                <textarea name="attr_description" style="height: 2em; width: 380px; padding: 10px; background-position: 0 10px;"></textarea>
              </div>
            </div>
          </fieldset>
        </div>
        <div class="inlineBlock" style="width: 45%; vertical-align: top; margin-left: 1em;">
          <h2>Mundane Gear</h2>
          <textarea name="attr_gear" placeholder="Gear and equipment"></textarea>
          <label class="inlineLabel">Galactic Credits:</label>
          <input type="number" name="attr_money" style="width: 1.5in;"/>
          <div style="margin-bottom: 1em;">
            <div class="checkbox" style="width: 1in;">
              <input type="checkbox" name="attr_encumbered" title="Encumbered?: Check this if your character is carrying so much stuff that they're encumbered."/><span>Encumbered</span>
            </div>
            <label class="inlineLabel">Armor Penalty:</label>
            <input type="number" name="attr_armorPenalty"/>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="tab">
    <input type="radio" id="tab_6" name="mainTabs"/>
    <label for="tab_6">Notes</label>
    <div class="tabPanel">
      <div class="notesPanel">
        <textarea name="attr_notes" placeholder="Notes"></textarea>
      </div>
    </div>
  </div>
</div>
<script type="text/worker">/**
 * Forces an update on a list of numerical fields, also making sure that
 * any undefined fields are set to 0.
 * @param {string[]} attrs
 * @param {function} cb
 */
function forceUpdate(attrs, cb) {
  parseAttrs(attrs, values => {
    let tempValues = {};
    _.each(attrs, attr => {
      tempValues[attr] = -9999;
    });
    setAttrs(tempValues);
    setAttrs(values);
  });
}


function onChange(attrs, cb) {
  attrs = _.map(attrs, attr => {
    return 'change:' + attr;
  }).join(' ');
  on(attrs, cb);
}

function onChangeParse(attrs, cb) {
  onChange(attrs, () => {
    parseAttrs(attrs, cb);
  });
}

/**
 * Gets the specified attributes and parses them as an integer or 0.
 */
function parseAttrs(attrs, cb) {
  getAttrs(attrs, function(values) {
    _.each(attrs, function(attr) {
      if(_.isUndefined(values[attr]))
        values[attr] = 0;
      else if(!isNaN(values[attr]))
        values[attr] = parseInt(values[attr]);
    });
    cb(values);
  });
}

// Primary attr totals
function updatePrimaryAttrTotal(name) {
  let attrs = _.map(['Base', 'Perks', 'Other','Temp'], attr => {
    return name + attr;
  });
  onChangeParse(attrs, values => {
    setAttrs({
      [name + 'Total']: _.chain(values).values(values).reduce((m, n) => { return m + n; }).value()
    });
  });
}
updatePrimaryAttrTotal('mind');
updatePrimaryAttrTotal('body');
updatePrimaryAttrTotal('heart');

// Skills
function updateSkills(attrsTotal) {
  getSectionIDs('repeating_skills', ids => {
    _.each(ids, id => {
      var prefix = 'repeating_skills_' + id + '_';
      var attrs = _.map(['attr', 'trained', 'improved', 'greater', 'other', 'temp', 'rolltype', 'hasArmorPenalty'], name => {
        return prefix + name;
      });
      attrs.push('armorPenalty');

      parseAttrs(attrs, values => {
        values = {
          attr: values[prefix + 'attr'],
          trained: values[prefix + 'trained'],
          improved: values[prefix + 'improved'],
          greater: values[prefix + 'greater'],
          other: values[prefix + 'other'],
          temp: values[prefix + 'temp'],
          rolltype: values[prefix + 'rolltype'],
          hasArmorPenalty: values[prefix + 'hasArmorPenalty'],
          armorPenalty: values['armorPenalty']
        };
        var attrTotal = 0;
        if(values.attr === 'mind')
          attrTotal = attrsTotal.mind;
        else if(values.attr === 'body')
          attrTotal = attrsTotal.body;
        else if(values.attr === 'heart')
          attrTotal = attrsTotal.heart;

        var total = attrTotal + values.other + values.temp;
        if(values.improved)
          total += 2;
        if(values.greater)
          total += 2;
        if(values.hasArmorPenalty === 'Yes')
          total -= values.armorPenalty;

        var dice = '2d6';
        if(values.greater)
          dice = '3d6d1r<1';
        else if(values.improved || values.trained)
          dice = '3d6d1';

        if(values.rolltype === 'adv')
          dice = `{${dice},${dice}}kh1`;
        if(values.rolltype === 'dis')
          dice = `{${dice},${dice}}kl1`;

        var equation = total + ' + ' + dice;

        setAttrs({
          [prefix + 'attrValue']: attrTotal,
          [prefix + 'total']: total,
          [prefix + 'equation']: equation,
          debug: values.armorPenalty
        }, { silent: true });
      });
    });
  });
}

onChangeParse(['mindTotal', 'bodyTotal', 'heartTotal', 'armorPenalty'], values => {
  var attrsTotal = {
    mind: values.mindTotal,
    body: values.bodyTotal,
    heart: values.heartTotal
  };
  updateSkills(attrsTotal);
});

on('change:repeating_skills', () => {
  parseAttrs(['mindTotal', 'bodyTotal', 'heartTotal'], values => {
    var attrsTotal = {
      mind: values.mindTotal,
      body: values.bodyTotal,
      heart: values.heartTotal
    };
    updateSkills(attrsTotal);
  });
});

// Hide power points
on('change:repeating_powers', function() {
  getSectionIDs('repeating_powers', ids => {
    _.each(ids, id => {
      var prefix = 'repeating_powers_' + id + '_';
      parseAttrs([prefix + 'type'], values => {
        var type = values[prefix + 'type'];
        var hidePowerPoints = type === 'points' ? 0 : 1;

        setAttrs({
          [prefix + 'hidePowerPoints']: hidePowerPoints
        });
      });
    });
  });
});

</script>
<rolltemplate class="sheet-rolltemplate-mlprim5">
  <table>
    <thead>
      <tr>
        <th>{{charName}} &#x21D2; {{attr}}</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Result {{result}}</td>
      </tr>{{#notes}}
      <tr>
        <td class="notes">
          <div>Notes:</div>
          <div>{{notes}}</div>
        </td>
      </tr>{{/notes}}
    </tbody>
  </table>
</rolltemplate>